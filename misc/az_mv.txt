###Move an AZ


isi license add --evaluation=SMARTCONNECT_ADVANCED

###hit q and yes to accept eula




###on isilon make base AZ directory

mkdir -p /ifs/az1
mkdir -p /ifs/az1/data1
chmod -R  777 /ifs/az1
touch /ifs/az1/this_is_isilon.txt
chmod 777 /ifs/az1/this_is_isilon.txt


###make an az

isi zone create --name=az1 --path=/ifs/az1 


###1a.setup SmartConnect on Isilon


isi network subnets modify groupnet0.subnet0 --sc-service-addr=192.168.1.100 --sc-service-name=ssip-isilon.demo.local
isi network pools create --id=groupnet0:subnet0:pool1 --ranges=192.168.1.60-192.168.1.80  --access-zone=az1  --alloc-method=dynamic  --ifaces=1-3:ext-1 --sc-subnet=subnet0  --sc-dns-zone=az1.demo.local    --description=az_pool


###join AD
isi auth ads create demo.local administrator --password=Password123!
isi auth ads list
isi zone zones modify az1 --add-auth-providers=lsa-activedirectory-provider:DEMO.LOCAL
isi zone zones list -v

###Setup DNS

 
###Run the following PowerShell command:

-open PowerShell prompt from Start Menu
Add-DnsServerZoneDelegation -Name "demo.local" -ChildZoneName "az1" -NameServer "ssip-isilon.demo.local" -IPAddress 192.168.1.100


-Test SCzone:
-go to linux host and test
nslookup az1.demo.local 192.168.1.2




###3.create nfs export on Isilon for az1
isi nfs exports create --path=/ifs/az1/data1 --map-root=root  --zone=az1 --description=az_test_export
isi nfs exports list --zone=az1
isi nfs exports view --id=1 --zone=az1

###mount nfs 
mkdir /mnt/isilon-az/data1
mount -t nfs az.demo.local:/ifs/az1/data1 /mnt/isilon-az/dat1

cd /mnt/isilon-az/data1
ls -al

##test the nfs export
- create a file nfs.txt 
- open and edit the nfs.txt file
- look at the permissions on nfs.txt 
touch nfs.txt
ls -al
vi nfs.txt
ls -al
cat nfs.txt




###create additional nfs exports for test
mkdir /ifs/az1/data2
mkdir /ifs/az1/data3

isi nfs exports create --path=/ifs/az1/data2 --map-root=root  --zone=az1 --description=az_test_export
isi nfs exports create --path=/ifs/az1/data3 --map-root=root  --zone=az1 --description=az_test_export
isi nfs exports list --zone=az1



